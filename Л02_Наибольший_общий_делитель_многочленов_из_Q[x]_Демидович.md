# Наибольший общий делитель

Задача 1. Дано два многочлена $f$ и $g$. Требуется найти их наибольший общий делитель $h$. 

Задача 2. Дан идеал $(f,g)$ полиномиального кольца. Требуется найти его представление в виде главного идеала $(h)$. 

1.) Найдем НОД двух многочленов руками при помощи функции:


```python
def quo_rem_poly(f,q):
    K=f.parent()
    n=0
    while f.degree()>=q.degree():
        ni=K(f.lt()/q.lt())
        n=n+ni
        f=f-ni*q
    return (n,f)
```


```python
var("x")
f=QQ[x](x^3-2)
g=QQ[x](x^4 + x^3 - x - 1)
(u1,r1)=quo_rem_poly(f,g)
print((u1,r1))
```

    (0, x^3 - 2)


При этом $f-u_1 g = r_1$, то есть НОД(f,g)=НОД(g,r1).


```python
(u2,r2)=quo_rem_poly(g,r1)
print((u2,r2))
```

    (x + 1, x + 1)


При этом $g-u_2 r_1 = r_2$, то есть НОД(f,g)=НОД(r1,r2).


```python
(u3,r3)=quo_rem_poly(r1,r2)
print((u3,r3))
```

    (x^2 - x + 1, -3)


$r_1$ делится на $r_2$, поэтому НОД(f,g)=r2. 

2.) Напишем свою функцию gcd_poly. Вход: многочлены f,g, выход: их НОД. 


```python
def gcd_poly(f,g):
    if f.degree()<g.degree():
        (f,g)=(g,f)
    (u,r)=quo_rem_poly(f,g)
    while r!=0 or r.degree()==0:
        (f,g)=(g,r)
        (u,r)=quo_rem_poly(f,g)
    if g.degree()==0:
        g=1
    return g
```

3.) Проверим на нескольких тестовых примерах.


```python
f=QQ[x](x^3-2)
g=QQ[x](x^4 + x^3 - x - 1)
gcd_poly(f,g)
```




    1




```python
f=QQ[x]((x^3+1)^2*(x^3-2*x-1))
g=QQ[x]((x^3+1)^2*(x^4+1))
gcd_poly(f,g).factor()
```




    (8/9) * (x + 1)^2 * (x^2 - x + 1)^2




```python
f = QQ[x]((2*x^5+12)*(x^4+3*x^2+12)^6)
g = QQ[x]((4*x^5+x+10)*(x^4+5*x^2+11)^6)
gcd_poly(f, g).factor()
```




    1



4.) Проверим на тестовых примерах с коэффцинетами в полях $\mathbb{R}, \mathbb{C}$ и GF(5).


```python
f=QQbar[x](x^3-1)
g=QQbar[x](x^3 + x^2 - x - 1)
gcd_poly(f,g)
```




    x - 1




```python
f=QQbar[x](x^3-i)
g=QQbar[x](x^3 + x^2 + 2)
gcd_poly(f,g)
```




    1




```python
f=QQbar[x](x^3-i)
g=QQbar[x]((x+i)*(x^2+3+i))
gcd_poly(f,g).factor()
```




    (-7*I - 12) * (x + I)




```python
f.factor()
```




    (x - 0.866025403784439? - 0.500000000000000?*I) * (x + I) * (x + 0.866025403784439? - 0.500000000000000?*I)




```python
f = QQbar[x](x^2 + 1)
g = QQbar[x]((x^4+3*2*x^3+x^2+1)*(x+i))
gcd_poly(f,g).factor()
```




    (-6*I + 1) * (x + I)




```python
f=GF(5)[x](x^3-1)
g=GF(5)[x](x^3 + x^2 - x - 1)
gcd_poly(f,g)
```




    x + 4




```python
f.factor()
```




    (x + 4) * (x^2 + x + 1)




```python
g.factor()
```




    (x + 4) * (x + 1)^2




```python
f = GF(5)[x](x^3+8)
g = GF(5)[x]((x+2)*(x^2+2))
gcd_poly(f, g)
```




    3*x + 1



4.) Проверим на тестовых примерах с большими степенями


```python
var("x")
f=sum([(n+1)*x^n for n in range(10^3)])
g=sum([x^n for n in range(20)])
%time gcd_poly(QQ[x](f),QQ[x](g))
```

    CPU times: user 547 ms, sys: 0 ns, total: 547 ms
    Wall time: 549 ms





    1



5.) Составьте уравнение, которому удовлетворяют кратные корни уравнения $f(x)=0$, где $f \in \mathbb{Q}[x]$.
Напоминание. Если многочлен $f \in \mathbb{Q}[x]$ имеет кратые неприводимые множители, то эти множители входят и в $f'$. Комплексные корни неприводимых множителей "--- простые. 


```python
f=QQ[x](x^11 + 4*x^10 + 4*x^9 - 3*x^8 - 6*x^7 - 6*x^4 - 3*x^3 + 4*x^2 + 4*x + 1)
g=gcd_poly(f,diff(f,x))
g
```




    -10752/121*x^7 - 53760/121*x^6 - 96768/121*x^5 - 53760/121*x^4 + 53760/121*x^3 + 96768/121*x^2 + 53760/121*x + 10752/121



Проверка средставим Sage:


```python
f.factor()
```




    (x - 1)^2 * (x + 1)^7 * (x^2 - x + 1)




```python
g.factor()
```




    (-10752/121) * (x - 1) * (x + 1)^6




```python
f = QQ[x]((x^4 + 3)^2*(x+16)^3*(x^3-1))
g = gcd_poly(f, diff(f, x))
g
```




    -1044335351097662806788488619364909045794967886155156526552808188928/18081023532696066380995357391261567071423446329344045223964459769*x^6 - 33418731235125209817231635819677089465438972356965008849689862045696/18081023532696066380995357391261567071423446329344045223964459769*x^5 - 267349849881001678537853086557416715723511778855720070797518896365568/18081023532696066380995357391261567071423446329344045223964459769*x^4 - 3133006053292988420365465858094727137384903658465469579658424566784/18081023532696066380995357391261567071423446329344045223964459769*x^2 - 100256193705375629451694907459031268396316917070895026549069586137088/18081023532696066380995357391261567071423446329344045223964459769*x - 802049549643005035613559259672250147170535336567160212392556689096704/18081023532696066380995357391261567071423446329344045223964459769




```python
f.factor()
```




    (x - 1) * (x + 16)^3 * (x^2 + x + 1) * (x^4 + 3)^2




```python
g.factor()
```




    (-1044335351097662806788488619364909045794967886155156526552808188928/18081023532696066380995357391261567071423446329344045223964459769) * (x + 16)^2 * (x^4 + 3)



6.) Составьте уравнение, все комплексные корни которого простые, и совпадают с корнями заданного уравнения.


```python
f=QQ[x](x^11 + 4*x^10 + 4*x^9 - 3*x^8 - 6*x^7 - 6*x^4 - 3*x^3 + 4*x^2 + 4*x + 1)
g=gcd_poly(f,diff(f,x))
(u,r)=quo_rem_poly(f,g)
u/(u).lc()
```




    x^4 - x^3 + x - 1



Проверка средствами Sage:


```python
(u/(u).lc()).factor()
```




    (x - 1) * (x + 1) * (x^2 - x + 1)




```python
f.factor()
```




    (x - 1)^2 * (x + 1)^7 * (x^2 - x + 1)




```python
f = QQ[x]((x+1)^2*(2*x+1)^4)
g = gcd_poly(f, diff(f, x))
(u, r) = quo_rem_poly(f, g)
u/(u).lc()
```




    x^2 + 3/2*x + 1/2




```python
(u/(u).lc()).factor()
```




    (x + 1/2) * (x + 1)




```python
f.factor()
```




    (16) * (x + 1)^2 * (x + 1/2)^4




```python

```
